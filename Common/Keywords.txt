*** Keywords ***
Open Intranet and Login	
	${profile}=		create_ff_profile		${profileAddress}
	Open Browser	${urlOfIntranet}		${browser}		remote_url=http://192.168.0.104:4444/wd/hub		ff_profile_dir=${profile}
	Maximize Browser Window
	Wait Until Element Is Visible		${EnterUsername}
	Input Text			${EnterUsername}		${username}
	Input Text			${EnterPassword}		${password}	
	Click Element		${LoginButton}
	
Logout And Close Browser
	Wait Until Element Is Visible		${LogoutLink}	timeout=10s
	Click Element		${LogoutLink}
	Wait Until Element Is Visible		${EnterUsername}	timeout=10s
	Close Browser
		
Verify All Dates Of This Month
	[Arguments]			${DateValue}
	: For		${item}		IN		@{DateValue}
	\	Should Be True		'${item}'>='01'
	\	Should Be True		'${item}'<='31'
	
Select Date From Options And Verify
	[Arguments]			${TableCell}
	Click Element		${SearchDateList}
	Wait Until Element Is Visible		${SelectDateOptionSuggestions}
	${totalSuggestions}=		Get Element Count		${SelectDateOptionSuggestions}
	: FOR		${suggestionNum}		IN RANGE		1		${totalSuggestions}
	\	Click Element		${SearchDateList}
	\	Wait Until Element Is Visible		${SelectDateOptionSuggestions}
	\	${num}=		Convert To String		${suggestionNum}
	\	${SelectDateOption}=		Replace String			${SelectDateOption}		NUM			${num}
	\	${dateValue}=		Get Value		${SelectDateOption}
	\	Click Element		${SelectDateOption}
	\	Wait Until Element Is Visible		${TableRows}
	\	${ColumnValues}=	Get Data From Columns		${TableCell}
	\	${SelectDateOption}=		Replace String			${SelectDateOption}		${num}		NUM	
	\	Continue For Loop If		${ColumnValues}==[]
	\	Verify All Date According to Selected Date			${ColumnValues}			${dateValue}
	
Verify All Date According to Selected Date
	[Arguments]			${DateList}			${dateValue}
	: For	${item}		IN		@{DateList}	
	\	Should Be Equal			${item}		${dateValue}

Verify Today's Date And Get Employee's Name
	[Arguments]		${DateCell}
	${today'sDate}=		Get Time		day
	Click Element		${SearchDateList}
	Wait Until Element Is Visible		${SelectDateOptionSuggestions}
	${num}=		Convert To String		${today'sDate}
	${SelectDateOption}=		Replace String			${SelectDateOption}		NUM			${num}
	${dateValue}=		Get Value		${SelectDateOption}
	Click Element		${SelectDateOption}
	Wait Until Element Is Visible		${TableRows}
	@{employeeList}=		Create List
	${totalRows}=		Get Element Count		${TableRows}
	: FOR		${row}		IN RANGE		2	${totalRows}+1
	\	${rowNum}=		Convert To String		${row}
	\	${DateCell}=		Replace String			${DateCell}		ROW		${rowNum}
	\	${NameDateCell}=		Replace String			${NameDateCell}		ROW		${rowNum}
	\	Element Should Contain		${DateCell}		${today'sDate}
	\	${employeeName}=		Get Text		${NameDateCell}
	\	Append To List			${employeeList}		${employeeName}
	\	${DateCell}=		Replace String			${DateCell}		${rowNum}		ROW		count=1	
	\	${NameDateCell}=		Replace String			${NameDateCell}		${rowNum}		ROW		count=1	
	Return From Keyword			${employeeList}

Verify Employee Name From Wishing You Section
	[Arguments]			${employeeList}		${Greeting}
	Wait Until Element Is Visible		${HomeButton}		timeout=15s
	Click Element		${HomeButton}
	Wait Until Element Is Visible		${WishingYouSection}		timeout=15s
	: FOR		${name}		IN		 @{employeeList}
	\	${EmployeeNameLink}=		Replace String		${EmployeeNameLink}		NAME	${name}
	\	Wait Until Element Is Visible			${EmployeeNameLink}			timeout=60s
	\	Element Should Contain		${WishingYouSection}		${name}
	\	Element Should Contain		${WishingYouSection}		${Greeting}
	\	${EmployeeNameLink}=		Replace String		${EmployeeNameLink}		${name}		NAME

Verify All Columns Data From Employee Details For All Rows
	${TotalRows}=		Get Element Count		${TableRows}
	: FOR		${row}		IN RANGE		1		${TotalRows}+1
	\	${rowNumber}=		Convert To String		${row}
	\	Get Data From All Columns And Verify		${TableCellValues}		${rowNumber}
	\	Wait Until Element Is Visible		${TableRows}

Get Data From All Columns And Verify
	[Arguments]			${TableCellValues}		${rowNumber}
	${EyeIcon}=		Replace String			${EyeIcon}		ROW			${rowNumber}
	${TableCellValues}=		Replace String			${TableCellValues}		ROW			${rowNumber}
	${ColumnsList}=		Replace String			${ColumnsList}		ROW			${rowNumber}
	&{columnsDict}=		Create Dictionary
	Log		${columnsDict}	
	${columnCellValueList}=		Get WebElements		${ColumnsList}
	${length}=		Get Length		${headerName}
	: FOR		${column}		IN RANGE		1		${length}+1
	\	${cellValue}=		Get Text		${columnCellValueList[${column}]}
	\	Set To Dictionary			${columnsDict}		${headerName[${column}-1]}		${cellValue}
	\	Log				${columnsDict}
	Click Element		${EyeIcon}
	Wait Until Element Is Visible		${EmployeeBirthdayDateBox}		timeout=15s
	${statusName}=				Run Keyword And Return Status			Element Should Contain			${EmployeeNameBox}				${columnsDict["${headerName[0]}"]}
	${statusRAName}=			Run Keyword And Return Status			Element Should Contain			${EmployeeRANameBox}			${columnsDict["${headerName[1]}"]}
	${statusDesignation}=		Run Keyword And Return Status			Element Should Contain			${EmployeeDesignationBox}		${columnsDict["${headerName[2]}"]}
	${experience}=		Split String			${columnsDict["${headerName[3]}"]}			.	
	${statusExperienceYear}=		Run Keyword And Return Status			Element Should Contain			${EmployeeExperienceBox}		${experience[0]}
	${statusExperienceMonth}=		Run Keyword And Return Status			Element Should Contain			${EmployeeExperienceBox}		${experience[1]}
	${statusMobileNo}=			Run Keyword And Return Status			Element Should Contain			${EmployeeMobileNoBox}			${columnsDict["${headerName[4]}"]}
	${statusDepartment}=		Run Keyword And Return Status			Element Should Contain			${EmployeeDepartmentBox}		${columnsDict["${headerName[5]}"]}
	${statusEmailId}=			Run Keyword And Return Status			Element Should Contain			${EmployeeEmailIdBox}			${columnsDict["${headerName[6]}"]}
	${statusLocation}=			Run Keyword And Return Status			Element Should Contain			${EmployeeLocationBox}			${columnsDict["${headerName[7]}"]}
	Go Back
	Wait Until Element Is Visible		${TableRows}
	${EyeIcon}=		Replace String			${EyeIcon}		${rowNumber}		ROW	
	${TableCellValues}=		Replace String			${TableCellValues}		${rowNumber}		ROW
	
Get Data From Columns	
	[Arguments]			${TableCell}
	Wait Until Element Is Visible		${TableRows}		timeout=15s
	@{ColumnValues}=			Create List
	${ColumnValues}=		Get Data From All Pages		${ColumnValues}		${TableCell}
	Return From Keyword			${ColumnValues}

Get Data From All Pages
	[Arguments]		${ColumnValues}			${TableCell}
	: For		${page}		IN RANGE		500	
	\	${ColumnValues}=		Get Data From All Rows 		${ColumnValues}			${TableCell}
	\	${status}=		Run Keyword And Return Status		Wait Until Element Is Visible		${NextButtonLink}
	\	Run Keyword If		${status}==True			Click Element		${NextButtonLink}
	\	...		ELSE		Exit For Loop
	\	Wait Until Element Is Visible		${TableRows}		timeout=25s
	\	${page}=		Evaluate		${page}+1
	Log		${ColumnValues}
	Return From Keyword			${ColumnValues}
	${categoryName}=		Get Text		${ClassifiedMenuButtons}

Get Data From All Rows
	[Arguments]		${ColumnValues}		${TableCell}
	${totalRows}=		Get Element Count		${TableRows}
	: For		${row}		IN RANGE		1		${totalRows}
	\	${rowNum}=		Convert To String		${row}
	\	${TableCell}=		Replace String			${TableCell}		ROW		${rowNum}
	\	${valueCol}=		Get Text			${TableCell}
	\	${TableCell}=		Replace String			${TableCell}		${rowNum}		ROW		count=1	
	\	${value}=		Convert To Lowercase		${valueCol}
	\	${value}=		Split String		${value}		\n
	\	${value}=		Split String		${value[0]}		${SPACE}
	\	${value}=		Split String		${value[0]}		.
	\	${status}=		Run Keyword And Return Status		List Should Contain Value		${valueCol}		all	
	\	Continue For Loop If		${status}==True
	\	Append To List		${ColumnValues}			${value[0]}
	\	Log		${ColumnValues}
	Return From Keyword			${ColumnValues}
		
Verify Column According To Ascending Sorting   
	[Arguments]		${ColumnValues}
	${newValuesList}=		Copy List		${ColumnValues}
	Sort List		${ColumnValues}
	Log		${ColumnValues}
	Log		${newValuesList}
	${statusEquality}=		Run Keyword And Return Status		Lists Should Be Equal		${newValuesList}		${ColumnValues}

Verify Column According To Descending Sorting
	[Arguments]		${ColumnValues}
	${newValuesList}=		Copy List		${ColumnValues}
	Log		${ColumnValues}
	Sort List		${ColumnValues}
	Log		${ColumnValues}
	Reverse List		${ColumnValues}
	Log		${ColumnValues}
	Log		${newValuesList}
	${statusEquality}=		Run Keyword And Return Status		Lists Should Be Equal		${newValuesList}		${ColumnValues}

Verify Ascending And Descending Sorting For Numbers
	[Arguments]		${ColumnValues}
	Log			${ColumnValues}
	${statusEquality}=		Run Keyword And Return Status		Should Be Equal		${mainList}			${ColumnValues}		
	${status1}=			Run Keyword And Return Status			Element Should Be Visible		${SortTopPressedButton}
	${status2}=			Run Keyword And Return Status			Element Should Be Visible		${SortDownPressedButton}	
	${length}=		Get Length		${ColumnValues}
	: FOR		${num}		IN RANGE	0		${length}
	\	${value1}=		Set Variable	${ColumnValues[${num}]}
	\	Continue For Loop If		'${value1}'==''
	\	${value1}=		Convert To Number		${value1}
	\	${newNum}=		Evaluate	${num}+1
	\	Exit For Loop If		${newNum}>=${length}	
	\	${value2}=		Set Variable	${ColumnValues[${newNum}]}
	\	Continue For Loop If		'${value2}'==''
	\	${value2}=		Convert To Number		${value2}
	\	Run Keyword If		${status1}==True		Should Be True		${value1}<=${value2}
	\	Run Keyword If		${status2}==True		Should Be True		${value1}>=${value2}
	
Verify Ascending Sorting For Date
	[Arguments]		${ColumnValues}
	${length}=		Get Length		${ColumnValues}
	: FOR		${num}		IN RANGE		0	${length}
	\	${date1}=		Split String		${ColumnValues[${num}]}			-
	\	${newNum}=		Evaluate		${num}+1
	\	Exit For Loop If		${newNum}>=${length}
	\	${date2}=		Split String		${ColumnValues[${newNum}]}			-
	\	${status}=		Run Keyword And Return Status		Should Be True		'${date1[0]}'<='${date2[0]}'	
	\	${status1}=		Run Keyword If			'${date1[0]}'=='${date2[0]}'		Run Keyword And Return Status		Should Be True		'${date1[1]}'<='${date2[1]}'	
	\	${status2}=		Run Keyword If			'${date1[1]}'=='${date2[1]}' and '${date1[0]}'=='${date2[0]}'		Run Keyword And Return Status		Should Be True		${date1[2]}<=${date2[2]}

Verify Descending Sorting For Date
	[Arguments]		${ColumnValues}
	Log			${ColumnValues}
	${length}=		Get Length		${ColumnValues}
	: FOR		${num}		IN RANGE		0	${length}
	\	${date1}=		Split String		${ColumnValues[${num}]}			-
	\	${newNum}=		Evaluate		${num}+1
	\	Exit For Loop If		${newNum}>=${length}
	\	${date2}=		Split String		${ColumnValues[${newNum}]}			-
	\	${status}=		Run Keyword And Return Status		Should Be True		'${date1[0]}'>='${date2[0]}'
	\	${status1}=		Run Keyword If			'${date1[0]}'=='${date2[0]}'		Run Keyword And Return Status		Should Be True		'${date1[1]}'>='${date2[1]}'	
	\	${status2}=		Run Keyword If			'${date1[1]}'=='${date2[1]}' and '${date1[0]}'=='${date2[0]}'		Run Keyword And Return Status		Should Be True		'${date1[2]}'>='${date2[2]}'