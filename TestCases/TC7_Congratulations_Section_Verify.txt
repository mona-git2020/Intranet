*** Settings ***
Library		Selenium2Library	
Library		String
Library		Collections	
Resource	../Common/Common_Variables.txt
Resource	../Resources/Keywords.txt	
Suite Setup		Open Intranet and Login
Suite Teardown	Logout And Close Browser


*** Test Cases ***
Check Congratulations Section And Verify
	Wait Until Element Is Visible		${HomeButton}
	&{CongratulationsSectionData}=		Create Dictionary
	${totalCongratulationsList}=		Get Element Count		${CongratulationsEmployeeList}
	: FOR		${numCongratulations}		IN RANGE		1		${totalCongratulationsList}
	\	${num}=		Convert To String		${numCongratulations}
	\	Wait Until Element Is Visible		${CongratulationsEmployeeName}		timeout=3s	
	\	${name}=		Get Text		${CongratulationsEmployeeName}	
	\	${Detail}=		Get Text		${CongratulationsEmployeeDetail}
	\	Set To Dictionary			${CongratulationsSectionData}			${name}		${Detail}
	\	Log		${CongratulationsSectionData}	
	\	Wait Until Element Is Not Visible		Link=${name}
	
	${year}=		Get Time		Year
	${year}=		Evaluate		${year}-7
	${year}=		Convert To String		${year}	
	${keys}=		Get Dictionary Keys			${CongratulationsSectionData}		

	: FOR		${key}		IN		@{keys}
	\	Log		${key}
	\	Wait Until Element Is Visible			Link=${key}			timeout=60s	
	\	Click Element		Link=${key}
	\	Wait Until Element Is Visible		${EmployeeDetailBox}
	\	${status}=		Run Keyword And Return Status		Should Contain Any			${CongratulationsSectionData['${key}']}		5
	\	Run Keyword If		${status}==True			Element Should Contain			${CongratulationsJoiningDate}			${year}
	\	...			ELSE		Verify Certification Of Employees
	\	Go Back
	\	Wait Until Element Is Visible		${CongratulationsEmployeeName}	
	
	
*** Keywords ***		
Verify Certification Of Employees
	Click Element			${CongratulationsCertification}
	Wait Until Element Is Visible		${CertifivationTable} 
	Element Should Contain			${CertifivationTable}		Certified
	Click Element			${CloseButton}
	Wait Until Element Is Visible		${EmployeeDetailBox}
	
	
	
