*** Settings ***
Library		Selenium2Library	
Library		String
Library		Collections	
Resource	../Common/Common_Variables.txt
Resource	../Resources/Keywords.txt	
Suite Setup		Open Intranet and Login
Suite Teardown	Logout And Close Browser


*** Test Cases ***
Open Holiday List Select Year, Month, Branch and Verify 
	Wait Until Element Is Visible		${HomeButton}
	Mouse Over		${HomeButton}
	Wait Until Element Is Visible		${HolidayListMenu}
	Click Element	${HolidayListMenu}
	Wait Until Element Is Visible		${TableRows}
	Click Element			${SelectYear}
	${yearValue}=		Get Value		${SelectYearOption}
	Click Element			${SelectYearOption}
	Click Element			${SelectBranch}
	Click Element			${SelectBranchOption}
	${branchValue}=		Get Text		${SelectBranchOption}
	Click Element			${SelectMonth}
	${monthValue}=		Get Value		${SelectMonthOption}
	${monthValue}=		Evaluate	${monthValue}+1
	${monthValue}=		Convert To String		${monthValue}
	Click Element			${SelectMonthOption}
	Click Element			${SubmitButton}
	Wait Until Element Is Visible		${TableRows}
	
	${totalRowsNum}=		Get Element Count		${TableRows}
	: FOR		${row}		IN RANGE		1	${totalRowsNum}+1
	\	${rowNumber}=		Convert To String		${row}
	\	${BranchNameTableCell}=		Replace String			${BranchNameTableCell}		ROW			${rowNumber}
	\	${DateTableCell}=			Replace String			${DateTableCell}		ROW			${rowNumber}
	\	Element Should Contain			${BranchNameTableCell}			${branchValue}
	\	Element Should Contain			${DateTableCell}			${yearValue}
	\	Element Should Contain			${DateTableCell}			${monthValue}	
	\	${BranchNameTableCell}=		Replace String			${BranchNameTableCell}		${rowNumber}		ROW
	\	${DateTableCell}=			Replace String			${DateTableCell}		${rowNumber}		ROW

	
	
